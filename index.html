<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PotluckManager ‚Äì Setup (Bootstrap MVP)</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      :root {
        --pm-green-dark: #2e7d32;
        --pm-green: #4caf50;
        --pm-green-light: #e8f5e9;
        --pm-bg: #f5f7fb;
      }

      body {
        /* ÏùÄÏùÄÌïú Ï¥àÎ°ù Í∑∏ÎùºÎç∞Ïù¥ÏÖò Î∞∞Í≤Ω */
        background: radial-gradient(circle at top left, #e8f5e9 0, #f7f7fb 55%, #f5f7fb 100%);
        min-height: 100vh;
      }

      .navbar {
        background: #ffffffcc;
        backdrop-filter: blur(8px);
      }

      .navbar-brand {
        font-weight: 700;
        color: var(--pm-green-dark);
      }

      .navbar-brand:hover {
        color: #1b5e20;
      }

      .page-subtitle {
        max-width: 720px;
        margin: 0 auto;
      }

      .sticky-preview {
        position: sticky;
        top: 1rem;
      }

      .date-pill {
        border-radius: 999px;
        background: #ffffff;
        border: 1px solid #e0e7f0;
        padding: 0.5rem 0.9rem;
      }

      .weekday .form-check {
        margin-right: 0.75rem;
      }

      .muted {
        color: #6c757d;
      }

      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
      }

      .section-title {
        font-size: 0.98rem;
        font-weight: 600;
        border-bottom: 1px solid #e0e7f0;
        padding-bottom: 0.3rem;
        margin-bottom: 0.75rem;
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }

      .section-title span.icon {
        font-size: 1.05rem;
      }

      .card-main {
        border-radius: 1.25rem;
        border: 0;
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.06);
      }

      .card-side {
        border-radius: 1rem;
        border: 0;
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.06);
      }

      .card-main .card-body {
        background: #ffffff;
      }

      .card-side .card-body {
        background: #ffffff;
      }

      .form-label {
        font-size: 0.78rem;
        font-weight: 500;
      }

      .form-control-sm,
      .form-select-sm {
        font-size: 0.85rem;
        padding: 0.35rem 0.6rem;
      }

      .btn-success {
        background-color: var(--pm-green);
        border-color: var(--pm-green);
      }

      .btn-success:hover {
        background-color: #43a047;
        border-color: #388e3c;
      }

      /* ÌûàÏñ¥Î°ú Ïπ¥Îìú Ïä§ÌÉÄÏùº */
      .hero-card {
        border-radius: 1.5rem;
        background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 40%, #f1f8e9 100%);
        border: 1px solid #d5e8d9;
        padding: 1.5rem 1.75rem;
      }

      .hero-tag {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 0.15rem 0.6rem;
        border-radius: 999px;
        background: rgba(76, 175, 80, 0.08);
        color: var(--pm-green-dark);
        font-size: 0.72rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.04em;
      }

      .hero-illus {
        border-radius: 1.25rem;
        background: radial-gradient(circle at top, #c8e6c9 0, #a5d6a7 40%, #81c784 70%, #66bb6a 100%);
        color: #fdfdfd;
        min-height: 180px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 1rem;
        box-shadow: 0 10px 28px rgba(46, 125, 50, 0.35);
      }

      .hero-illus .emoji {
        font-size: 2.6rem;
        margin-bottom: 0.4rem;
      }

      .hero-illus p {
        font-size: 0.86rem;
        max-width: 220px;
        margin: 0;
        opacity: 0.92;
      }

      footer {
        color: #9ca3af;
      }

      @media (max-width: 767.98px) {
        .hero-card {
          padding: 1.1rem 1.2rem;
        }
        .hero-illus {
          margin-top: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- ÏÉÅÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò / Ìó§Îçî -->
    <nav class="navbar navbar-expand-lg navbar-light shadow-sm">
      <div class="container">
        <a class="navbar-brand" href="#">
          PotluckManager
        </a>
        <span class="navbar-text text-muted small">
          Simple community meal scheduling (Bootstrap + Supabase)
        </span>
      </div>
    </nav>

    <div class="container py-4 py-md-5">
      <!-- ÌûàÏñ¥Î°ú: ÌÖçÏä§Ìä∏ + ‚ÄúÏù¥ÎØ∏ÏßÄ ÎäêÎÇå‚Äù Î∞ïÏä§ -->
      <div class="mb-4 mb-md-5">
        <div class="hero-card">
          <div class="row g-3 g-md-4 align-items-center">
            <div class="col-md-7">
              <div class="hero-tag mb-2">
                <span>ü•¶ Nourishing meals</span>
                <span>‚Ä¢</span>
                <span>Community care</span>
              </div>
              <h1 class="h3 fw-semibold mb-2 mt-1">
                Create a Healthy Meal Schedule
              </h1>
              <p class="text-muted mb-1 page-subtitle">
                Coordinate home-cooked, nourishing meals for families who need support.
                Choose dates, capture allergies, and share a simple schedule with volunteers.
              </p>
              <p class="text-muted small mb-0">
                Built as a Bootstrap + Supabase MVP, inspired by platforms like
                TakeThemAMeal, but tailored for lightweight, community-driven use.
              </p>
            </div>
            <div class="col-md-5">
              <!-- Ïã§Ï†ú Ïù¥ÎØ∏ÏßÄÎ•º ÎÑ£Í≥† Ïã∂ÏúºÎ©¥ Ïù¥ div ÏïàÏóê <img>Î°ú ÍµêÏ≤¥ÌïòÎ©¥ Îê® -->
              <div class="hero-illus">
                <div class="emoji">ü•ó</div>
                <p>
                  ‚ÄúOne pot at a time.‚Äù<br />
                  Visualize each meal as a small act of care for someone‚Äôs week.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <form id="setupForm" class="row g-4 g-lg-5">
        <!-- Left: form -->
        <div class="col-lg-8">
          <div class="card shadow-sm card-main">
            <div class="card-body p-4 p-md-4">

              <!-- Meal Coordinator -->
              <div class="mb-4">
                <h2 class="section-title">
                  <span class="icon">üë©‚Äçüç≥</span>
                  <span>Meal Coordinator</span>
                </h2>
                <div class="row g-3 mt-1">
                  <div class="col-sm-6">
                    <label class="form-label">First Name</label>
                    <input class="form-control form-control-sm" id="coordFirst" required />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Last Name</label>
                    <input class="form-control form-control-sm" id="coordLast" required />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Email</label>
                    <input
                      type="email"
                      class="form-control form-control-sm"
                      id="coordEmail"
                      required
                    />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Phone (optional)</label>
                    <input class="form-control form-control-sm" id="coordPhone" />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label"
                      >Admin Password
                      <span class="text-muted small">(min 4 chars)</span></label
                    >
                    <input
                      type="password"
                      class="form-control form-control-sm"
                      id="adminPw"
                      minlength="4"
                      required
                    />
                  </div>
                </div>
              </div>

              <!-- Recipient -->
              <div class="mb-4">
                <h2 class="section-title">
                  <span class="icon">üè°</span>
                  <span>Meal Recipient</span>
                </h2>
                <div class="row g-3 mt-1">
                  <div class="col-sm-6">
                    <label class="form-label">First Name</label>
                    <input class="form-control form-control-sm" id="recFirst" required />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Last Name</label>
                    <input class="form-control form-control-sm" id="recLast" required />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Email (optional)</label>
                    <input type="email" class="form-control form-control-sm" id="recEmail" />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Phone (optional)</label>
                    <input class="form-control form-control-sm" id="recPhone" />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label"
                      >User Password
                      <span class="text-muted small"
                        >(for volunteers)</span
                      ></label
                    >
                    <input class="form-control form-control-sm" id="userPw" required />
                  </div>
                </div>
              </div>

              <!-- Address -->
              <div class="mb-4">
                <div class="d-flex justify-content-between align-items-center">
                  <h2 class="section-title mb-0">
                    <span class="icon">üìç</span>
                    <span>Delivery Address</span>
                  </h2>
                  <button class="btn btn-link p-0 small" type="button" id="toggleIntl">
                    Switch to International Address
                  </button>
                </div>
                <div id="usAddress" class="row g-3 mt-1">
                  <div class="col-12">
                    <label class="form-label">Address</label>
                    <input class="form-control form-control-sm" id="addr1" />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">City</label>
                    <input class="form-control form-control-sm" id="city" />
                  </div>
                  <div class="col-sm-3">
                    <label class="form-label">State</label>
                    <select class="form-select form-select-sm" id="state"></select>
                  </div>
                  <div class="col-sm-3">
                    <label class="form-label">ZIP</label>
                    <input class="form-control form-control-sm" id="zip" />
                  </div>
                </div>
                <div id="intlAddress" class="mt-2 d-none">
                  <label class="form-label">International Address</label>
                  <textarea class="form-control form-control-sm" id="intl" rows="3"></textarea>
                </div>
              </div>

              <!-- Date window -->
              <div class="mb-4">
                <h2 class="section-title">
                  <span class="icon">üóìÔ∏è</span>
                  <span>When Are Meals Needed?</span>
                </h2>
                <div class="row g-3 mt-1">
                  <div class="col-sm-6">
                    <label class="form-label">Start Meals</label>
                    <input type="date" class="form-control form-control-sm" id="startDate" />
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label">Stop Meals</label>
                    <input type="date" class="form-control form-control-sm" id="endDate" />
                  </div>
                </div>
                <div class="mt-2 weekday">
                  <label class="form-label">Weekdays</label>
                  <div class="d-flex flex-wrap">
                    <!-- checkboxes inserted by JS -->
                  </div>
                  <div class="form-text">
                    Select at least one weekday. You can edit dates later.
                  </div>
                </div>
              </div>

              <!-- Allergies -->
              <div class="mb-4">
                <h2 class="section-title">
                  <span class="icon">‚ö†Ô∏è</span>
                  <span>Allergies</span>
                </h2>
                <div id="allergies" class="d-flex flex-wrap gap-3 mb-2">
                  <!-- allergen chips inserted by JS -->
                </div>
                <div class="mt-2">
                  <label class="form-label">Other Allergies</label>
                  <input
                    class="form-control form-control-sm"
                    id="otherAllergy"
                    placeholder="e.g., cilantro, pork, spicy foods"
                  />
                </div>
              </div>

              <!-- Notes -->
              <div class="mb-3">
                <h2 class="section-title">
                  <span class="icon">üìù</span>
                  <span>Notes and Instructions</span>
                </h2>
                <textarea
                  class="form-control form-control-sm"
                  id="notes"
                  rows="4"
                  placeholder="Household size, likes/dislikes, drop-off instructions..."
                ></textarea>
              </div>

              <!-- Submit -->
              <div class="mt-4 d-flex align-items-center gap-3">
                <button type="submit" class="btn btn-success px-4">
                  Create Meal Schedule
                </button>
                <div id="errorBox" class="text-danger small"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right: preview -->
        <div class="col-lg-4">
          <div class="sticky-preview">
            <div class="card shadow-sm card-side mb-3">
              <div class="card-body">
                <h3 class="h6 mb-2">Live Schedule Preview</h3>
                <div
                  id="dateList"
                  class="mt-2"
                  style="
                    max-height: 380px;
                    overflow: auto;
                    border: 1px solid #e0e7f0;
                    border-radius: 0.9rem;
                    padding: 0.55rem;
                    background: #f9fafb;
                  "
                ></div>
              </div>
            </div>

            <div class="card shadow-sm card-side mb-3">
              <div class="card-body">
                <h3 class="h6 mb-2">Allergy Summary</h3>
                <ul id="allergySummary" class="small mb-0"></ul>
              </div>
            </div>

            <div class="card shadow-sm card-side">
              <div class="card-body">
                <h3 class="h6 mb-2">Share Settings</h3>
                <div class="small mb-1">
                  User Password:
                  <span class="mono" id="userPwPreview"></span>
                </div>
                <div class="small">
                  Admin Password:
                  <span class="mono" id="adminPwPreview"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <footer class="pt-4 mt-4 border-top text-center small">
        APCV 498 Senior Capstone ¬∑ PotluckManager (Bootstrap + Supabase)
      </footer>
    </div>

    <!-- App logic (preview/validators/helpers) -->
    <script>
      const US_STATES = [
        "AK","AL","AR","AZ","CA","CO","CT","DC","DE","FL",
        "GA","HI","IA","ID","IL","IN","KS","KY","LA","MA",
        "MD","ME","MI","MN","MO","MS","MT","NC","ND","NE",
        "NH","NJ","NM","NV","NY","OH","OK","OR","PA","RI",
        "SC","SD","TN","TX","UT","VA","VT","WA","WI","WV",
        "WY","AA","AE","AP","AS","FM","GU","MH","MP","PR",
        "PW","VI"
      ];
      const WEEKDAYS = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
      const ALLERGENS = [
        "Eggs",
        "Fish",
        "Dairy",
        "Tree Nuts",
        "Peanuts",
        "Shellfish",
        "Soy",
               "Gluten",
      ];

      function fmtDate(date) {
        return new Intl.DateTimeFormat("en-US", {
          weekday: "short",
          month: "short",
          day: "numeric",
          year: "numeric",
        }).format(date);
      }
      function toISO(d) {
        return d.toISOString().slice(0, 10);
      }
      function addMonths(date, months) {
        const d = new Date(date);
        d.setMonth(d.getMonth() + months);
        return d;
      }

      function generateDates(startStr, endStr, enabled) {
        if (!startStr || !endStr) return [];
        const start = new Date(startStr + "T00:00:00");
        const end = new Date(endStr + "T00:00:00");
        if (end < start) return [];
        const set = new Set(enabled);
        const out = [];
        for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
          const label = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"][d.getDay()];
          if (set.has(label)) out.push(new Date(d));
        }
        return out;
      }

      // init selects/checkboxes
      const stateSel = document.getElementById("state");
      US_STATES.forEach((s) => {
        const o = document.createElement("option");
        o.value = o.textContent = s;
        stateSel.appendChild(o);
      });
      stateSel.value = "AZ";

      const weekdayWrap = document.querySelector(".weekday .d-flex");
      WEEKDAYS.forEach((w) => {
        const id = `wd_${w}`;
        const div = document.createElement("div");
        div.className = "form-check form-check-inline";
        div.innerHTML = `<input class="form-check-input" type="checkbox" id="${id}" checked> <label class="form-check-label" for="${id}">${w}</label>`;
        weekdayWrap.appendChild(div);
      });

      const allergiesDiv = document.getElementById("allergies");
      ALLERGENS.forEach((a) => {
        const id = `alg_${a.replace(/\s+/g, "")}`;
        const label = document.createElement("label");
        label.className = "form-check form-check-inline";
        label.innerHTML = `<input class="form-check-input" type="checkbox" id="${id}"> <span class="form-check-label">${a}</span>`;
        allergiesDiv.appendChild(label);
      });

      const startDate = document.getElementById("startDate");
      const endDate = document.getElementById("endDate");
      const today = new Date();
      startDate.value = toISO(today);
      endDate.value = toISO(addMonths(today, 2));

      // intl toggle
      let usingIntl = false;
      const toggleBtn = document.getElementById("toggleIntl");
      const usAddress = document.getElementById("usAddress");
      const intlAddress = document.getElementById("intlAddress");
      toggleBtn.addEventListener("click", () => {
        usingIntl = !usingIntl;
        toggleBtn.textContent = usingIntl
          ? "Switch to U.S. Address"
          : "Switch to International Address";
        usAddress.classList.toggle("d-none", usingIntl);
        intlAddress.classList.toggle("d-none", !usingIntl);
      });

      // preview
      const dateList = document.getElementById("dateList");
      const allergySummary = document.getElementById("allergySummary");
      const userPwPreview = document.getElementById("userPwPreview");
      const adminPwPreview = document.getElementById("adminPwPreview");
      const userPwInput = document.getElementById("userPw");
      const adminPwInput = document.getElementById("adminPw");

      function refreshPreview() {
        const enabled = WEEKDAYS.filter(
          (w) => document.getElementById(`wd_${w}`).checked
        );
        const list = generateDates(startDate.value, endDate.value, enabled);
        dateList.innerHTML = "";
        if (list.length === 0) {
          dateList.innerHTML =
            '<div class="text-muted small p-2">Select weekdays to generate dates.</div>';
        } else {
          list.forEach((d) => {
            const item = document.createElement("div");
            item.className =
              "d-flex justify-content-between align-items-center date-pill mb-2";
            item.innerHTML = `<span>${fmtDate(
              d
            )}</span><span class="muted">Open</span>`;
            dateList.appendChild(item);
          });
        }
        const items = [];
        ALLERGENS.forEach((a) => {
          const id = `alg_${a.replace(/\s+/g, "")}`;
          if (document.getElementById(id).checked) items.push(a);
        });
        const other = document.getElementById("otherAllergy").value.trim();
        allergySummary.innerHTML = "";
        if (items.length === 0 && !other) {
          allergySummary.innerHTML =
            '<li class="text-muted">No allergies listed</li>';
        }
        items.forEach((t) => {
          const li = document.createElement("li");
          li.textContent = t;
          allergySummary.appendChild(li);
        });
        if (other) {
          const li = document.createElement("li");
          li.textContent = "Other: " + other;
          allergySummary.appendChild(li);
        }

        userPwPreview.textContent = userPwInput.value || "(set above)";
        adminPwPreview.textContent = adminPwInput.value || "(set above)";
      }

      document.addEventListener("input", (e) => {
        if (
          e.target.closest(".weekday") ||
          e.target.id === "startDate" ||
          e.target.id === "endDate" ||
          e.target.id === "otherAllergy" ||
          (e.target.id || "").startsWith("alg_") ||
          e.target.id === "userPw" ||
          e.target.id === "adminPw"
        ) {
          refreshPreview();
        }
      });
      refreshPreview();
    </script>

    <!-- ‚úÖ SUBMIT + Supabase Ïó∞Í≤∞ -->
    <script>
      // 1) Ï†úÏ∂ú Ìï∏Îì§Îü¨ (async)
      const form = document.getElementById("setupForm");
      const errorBox = document.getElementById("errorBox");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        errorBox.textContent = "";

        // === Validation ===
        const errors = [];
        const req = (id, label) => {
          if (!document.getElementById(id).value.trim())
            errors.push(`${label} is required.`);
        };
        req("coordFirst", "Coordinator first name");
        req("coordLast", "Coordinator last name");
        req("coordEmail", "Coordinator email");
        if (document.getElementById("adminPw").value.trim().length < 4)
          errors.push("Admin password must be at least 4 characters.");
        req("recFirst", "Recipient first name");
        req("recLast", "Recipient last name");
        req("userPw", "User password");

        const enabled = WEEKDAYS.filter(
          (w) => document.getElementById(`wd_${w}`).checked
        );
        const dateListArr = generateDates(
          startDate.value,
          endDate.value,
          enabled
        );
        if (dateListArr.length === 0)
          errors.push("Select at least one weekday and a valid date range.");

        if (!usingIntl) {
          req("addr1", "Address");
          req("city", "City");
          req("state", "State");
          req("zip", "ZIP");
        } else {
          req("intl", "International address");
        }

        if (errors.length) {
          errorBox.textContent = errors.join(" ");
          return;
        }

        // === Payload ===
        const payload = {
          coordinator: {
            first: document.getElementById("coordFirst").value.trim(),
            last: document.getElementById("coordLast").value.trim(),
            email: document.getElementById("coordEmail").value.trim(),
            phone: document.getElementById("coordPhone").value.trim(),
            adminPw: document.getElementById("adminPw").value,
          },
          recipient: {
            first: document.getElementById("recFirst").value.trim(),
            last: document.getElementById("recLast").value.trim(),
            email: document.getElementById("recEmail").value.trim(),
            phone: document.getElementById("recPhone").value.trim(),
            userPw: document.getElementById("userPw").value,
          },
          address: !usingIntl
            ? {
                address: document.getElementById("addr1").value.trim(),
                city: document.getElementById("city").value.trim(),
                state: document.getElementById("state").value,
                zip: document.getElementById("zip").value.trim(),
              }
            : { international: document.getElementById("intl").value.trim() },
          window: {
            start: document.getElementById("startDate").value,
            end: document.getElementById("endDate").value,
          },
          weekdays: enabled,
          allergies: (() => {
            const map = {};
            ALLERGENS.forEach((a) => {
              const id = `alg_${a.replace(/\s+/g, "")}`;
              if (document.getElementById(id).checked) map[a] = true;
            });
            const other = document.getElementById("otherAllergy").value.trim();
            if (other) map.other = other;
            return map;
          })(),
          notes: document.getElementById("notes").value,
          schedule: dateListArr.map((d) => d.toISOString().slice(0, 10)),
        };

        console.log("Meal Schedule Payload:", payload);

        try {
          const slug = await saveToSupabase(payload);
          alert(
            `‚úÖ saved successfully!\nCheck your Supabase Table to confirm.`
          );
        } catch (err) {
          console.error(err);
          alert("‚ùå failed to save! check the error in Console.");
        }
      });

      // 2) Supabase Ï†ëÏÜç Ï†ïÎ≥¥
      const SUPABASE_URL = "https://hhuuwodljfgfhpwzbunt.supabase.co";
      const SUPABASE_ANON =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhodXV3b2RsamZnZmhwd3pidW50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxOTk0NjksImV4cCI6MjA3Nzc3NTQ2OX0.noNq4GxCuP3Bf0zAeMk9_D5wj4j8TsMLZHUEf5v8XNY";

      // 3) Ï†ÄÏû• Ìï®Ïàò
      function makeSlug() {
        return (
          new Date().toISOString().slice(0, 10).replaceAll("-", "") +
          "-" +
          Math.random().toString(36).slice(2, 7)
        );
      }

      async function saveToSupabase(payload) {
        const slug = makeSlug();
        const body = {
          slug,
          coordinator_first: payload.coordinator.first,
          coordinator_last: payload.coordinator.last,
          coordinator_email: payload.coordinator.email,
          recipient_first: payload.recipient.first,
          recipient_last: payload.recipient.last,
          address_json: payload.address,
          window_start: payload.window.start,
          window_end: payload.window.end,
          weekdays: payload.weekdays,
          notes: payload.notes,
          allergies: payload.allergies,
          user_pw_hash: payload.recipient.userPw, // Îç∞Î™® Îã®Í≥Ñ: ÌèâÎ¨∏ (ÌõÑÏóê Ìï¥Ïãú)
          admin_pw_hash: payload.coordinator.adminPw,
        };

        const res = await fetch(`${SUPABASE_URL}/rest/v1/schedules`, {
          method: "POST",
          headers: {
            apikey: SUPABASE_ANON,
            Authorization: `Bearer ${SUPABASE_ANON}`,
            "Content-Type": "application/json",
            Prefer: "return=representation",
          },
          body: JSON.stringify(body),
        });

        if (!res.ok) {
          const t = await res.text();
          throw new Error(`Supabase insert failed: ${res.status} ${t}`);
        }
        const [row] = await res.json();
        return row.slug;
      }
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
